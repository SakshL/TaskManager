import{r as e,j as a,B as t,z as s,bN as l,bO as r,bP as i,A as c,m as n,bQ as o,a7 as d,an as x,bR as m,p as u,F as p,bG as h,bD as b,bF as g,bE as y,bI as j,bL as f,bi as v,bJ as w,bK as N}from"./react-vendor-CvFIN_ac.js";import{b as k,a as C,L as S,d as T}from"./index-CJaCQS5E.js";const A=()=>{const{user:A}=k(),{success:L,error:M}=C(),[E,D]=e.useState([]),[F,z]=e.useState(!0),[P,O]=e.useState(!1),[B,I]=e.useState(""),[R,U]=e.useState("all"),[K,q]=e.useState("all"),[G,H]=e.useState(!1),[J,Q]=e.useState({title:"",type:"pdf",url:"",subject:"",description:"",tags:[],newTag:""}),V=["Mathematics","Physics","Chemistry","Biology","Computer Science","History","English","Psychology","Economics","Art","Other"],W=[{value:"pdf",label:"PDF Document",icon:l},{value:"video",label:"Video",icon:r},{value:"link",label:"Web Link",icon:i},{value:"note",label:"Text Note",icon:l}];e.useEffect(()=>{(async()=>{if(A)try{const e=h(T,"studyMaterials"),a=b(e,g("userId","==",A.uid),y("createdAt","desc")),t=(await j(a)).docs.map(e=>({id:e.id,...e.data()}));D(t)}catch(e){console.error("Error loading materials:",e),M("Failed to load study materials")}finally{z(!1)}})()},[A,M]);const Y=()=>{Q({title:"",type:"pdf",url:"",subject:"",description:"",tags:[],newTag:""})},_=()=>{J.newTag.trim()&&!J.tags.includes(J.newTag.trim())&&Q(e=>({...e,tags:[...e.tags,e.newTag.trim()],newTag:""}))},X=E.filter(e=>{const a=e.title.toLowerCase().includes(B.toLowerCase())||e.description?.toLowerCase().includes(B.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(B.toLowerCase())),t="all"===R||e.subject===R,s="all"===K||e.type===K;return a&&t&&s});return F?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx(S,{size:"lg"})}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Study Materials"}),a.jsx("p",{className:"text-gray-400",children:"Organize and access your study resources"})]}),a.jsxs("button",{onClick:()=>O(!0),className:"btn-primary flex items-center gap-2",children:[a.jsx(t,{className:"w-5 h-5"}),"Add Material"]})]}),a.jsx("div",{className:"glass rounded-2xl p-6 mb-8",children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(s,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search materials...",value:B,onChange:e=>I(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-black/20 border border-white/10 rounded-xl text-white placeholder-gray-400 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all"})]}),a.jsxs("select",{value:R,onChange:e=>U(e.target.value),className:"px-4 py-3 bg-black/20 border border-white/10 rounded-xl text-white focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all",children:[a.jsx("option",{value:"all",children:"All Subjects"}),V.map(e=>a.jsx("option",{value:e,children:e},e))]}),a.jsxs("select",{value:K,onChange:e=>q(e.target.value),className:"px-4 py-3 bg-black/20 border border-white/10 rounded-xl text-white focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all",children:[a.jsx("option",{value:"all",children:"All Types"}),W.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.jsx(c,{children:X.map(e=>{const t=(s=e.type,{pdf:l,video:r,link:i,note:l}[s]||l);var s;return a.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"glass rounded-2xl p-6 hover:shadow-glow transition-all duration-300 group",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-primary-500/20 rounded-xl",children:a.jsx(t,{className:"w-6 h-6 text-primary-400"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-white font-semibold line-clamp-1",children:e.title}),a.jsx("p",{className:"text-sm text-gray-400",children:e.subject})]})]}),a.jsx("button",{onClick:()=>(async e=>{try{await f(v(T,"studyMaterials",e)),D(a=>a.filter(a=>a.id!==e)),L("Material deleted successfully")}catch(a){console.error("Error deleting material:",a),M("Failed to delete material")}})(e.id),className:"opacity-0 group-hover:opacity-100 p-2 text-red-400 hover:bg-red-500/20 rounded-lg transition-all",children:a.jsx(o,{className:"w-4 h-4"})})]}),e.description&&a.jsx("p",{className:"text-gray-300 text-sm mb-4 line-clamp-2",children:e.description}),e.tags.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.tags.slice(0,3).map(e=>a.jsx("span",{className:"px-2 py-1 bg-accent-500/20 text-accent-400 text-xs rounded-lg",children:e},e)),e.tags.length>3&&a.jsxs("span",{className:"px-2 py-1 bg-gray-500/20 text-gray-400 text-xs rounded-lg",children:["+",e.tags.length-3," more"]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(d,{className:"w-4 h-4"}),e.createdAt?.toDate?.()?.toLocaleDateString()||"Unknown date"]}),a.jsx("span",{className:"capitalize",children:e.type})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>(e=>{window.open(e.url,"_blank")})(e),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-primary-500/20 text-primary-400 rounded-xl hover:bg-primary-500/30 transition-all",children:[a.jsx(x,{className:"w-4 h-4"}),"Open"]}),a.jsx("button",{onClick:()=>navigator.clipboard.writeText(e.url),className:"px-4 py-2 bg-white/5 text-gray-400 rounded-xl hover:bg-white/10 transition-all",title:"Copy URL",children:a.jsx(m,{className:"w-4 h-4"})})]})]},e.id)})})}),0===X.length&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(u,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No materials found"}),a.jsx("p",{className:"text-gray-400 mb-6",children:0===E.length?"Add your first study material to get started":"Try adjusting your search or filters"}),0===E.length&&a.jsx("button",{onClick:()=>O(!0),className:"btn-primary",children:"Add Your First Material"})]}),a.jsx(c,{children:P&&a.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:a.jsxs(n.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"glass rounded-3xl p-8 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:"Add Study Material"}),a.jsx("button",{onClick:()=>O(!1),className:"p-2 text-gray-400 hover:text-white transition-colors",children:a.jsx(p,{className:"w-6 h-6"})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Title *"}),a.jsx("input",{type:"text",value:J.title,onChange:e=>Q(a=>({...a,title:e.target.value})),className:"w-full px-4 py-3 bg-black/20 border border-white/10 rounded-xl text-white placeholder-gray-400 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all",placeholder:"Enter material title"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Type *"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:W.map(e=>{const t=e.icon;return a.jsxs("button",{onClick:()=>Q(a=>({...a,type:e.value})),className:"flex items-center gap-3 p-4 rounded-xl border transition-all "+(J.type===e.value?"border-primary-500 bg-primary-500/20 text-white":"border-white/10 text-gray-400 hover:border-white/20 hover:text-white"),children:[a.jsx(t,{className:"w-5 h-5"}),e.label]},e.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"URL/Link *"}),a.jsx("input",{type:"url",value:J.url,onChange:e=>Q(a=>({...a,url:e.target.value})),className:"w-full px-4 py-3 bg-black/20 border border-white/10 rounded-xl text-white placeholder-gray-400 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all",placeholder:"https://example.com/document.pdf"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Subject *"}),a.jsxs("select",{value:J.subject,onChange:e=>Q(a=>({...a,subject:e.target.value})),className:"w-full px-4 py-3 bg-black/20 border border-white/10 rounded-xl text-white focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all",children:[a.jsx("option",{value:"",children:"Select subject"}),V.map(e=>a.jsx("option",{value:e,children:e},e))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),a.jsx("textarea",{value:J.description,onChange:e=>Q(a=>({...a,description:e.target.value})),className:"w-full px-4 py-3 bg-black/20 border border-white/10 rounded-xl text-white placeholder-gray-400 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all resize-none",rows:3,placeholder:"Brief description of the material"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tags"}),a.jsxs("div",{className:"flex gap-2 mb-3",children:[a.jsx("input",{type:"text",value:J.newTag,onChange:e=>Q(a=>({...a,newTag:e.target.value})),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),_()),className:"flex-1 px-4 py-2 bg-black/20 border border-white/10 rounded-xl text-white placeholder-gray-400 focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition-all",placeholder:"Add a tag"}),a.jsx("button",{type:"button",onClick:_,className:"px-4 py-2 bg-primary-500/20 text-primary-400 rounded-xl hover:bg-primary-500/30 transition-all",children:"Add"})]}),J.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:J.tags.map(e=>a.jsxs("span",{className:"flex items-center gap-2 px-3 py-1 bg-accent-500/20 text-accent-400 rounded-lg text-sm",children:[e,a.jsx("button",{onClick:()=>{return a=e,void Q(e=>({...e,tags:e.tags.filter(e=>e!==a)}));var a},className:"text-accent-400 hover:text-accent-300",children:a.jsx(p,{className:"w-3 h-3"})})]},e))})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{onClick:()=>O(!1),className:"flex-1 px-6 py-3 border border-white/10 text-gray-400 rounded-xl hover:border-white/20 hover:text-white transition-all",children:"Cancel"}),a.jsx("button",{onClick:async()=>{if(A&&J.title&&J.url&&J.subject){H(!0);try{const e={title:J.title,type:J.type,url:J.url,subject:J.subject,description:J.description,tags:J.tags,userId:A.uid,createdAt:w.now()},a={id:(await N(h(T,"studyMaterials"),e)).id,...e};D(e=>[a,...e]),O(!1),Y(),L("Study material added successfully!")}catch(e){console.error("Error saving material:",e),M("Failed to save study material")}finally{H(!1)}}else M("Please fill in all required fields")},disabled:G||!J.title||!J.url||!J.subject,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:G?"Saving...":"Save Material"})]})]})]})})})]})})};export{A as default};
