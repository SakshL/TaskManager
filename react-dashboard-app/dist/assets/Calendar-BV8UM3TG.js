import{aP as e,r as t,j as s,au as a,aQ as r,aH as n,aI as i}from"./react-vendor-9sUWUj8V.js";import{c as l,b as o,L as d}from"./index-OjRGQQ76.js";import{s as c}from"./firestore-BtTgkdPP.js";const h=new class{initialized=!1;signedIn=!1;async initializeGapi(){this.initialized||(await new Promise((t,s)=>{e.load("client:auth2",{callback:()=>t(),onerror:()=>s(new Error("Failed to load GAPI"))})}),await e.client.init({apiKey:void 0,clientId:"217094234574-2jboolti9bbjj1ps4v4p284m6v2nnonq.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],scope:"https://www.googleapis.com/auth/calendar"}),this.initialized=!0,this.signedIn=e.auth2.getAuthInstance().isSignedIn.get())}async signIn(){try{this.initialized||await this.initializeGapi();const t=e.auth2.getAuthInstance();return this.signedIn||await t.signIn(),this.signedIn=!0,!0}catch(t){return console.error("Google Calendar sign-in failed:",t),!1}}async signOut(){if(this.initialized&&this.signedIn){const t=e.auth2.getAuthInstance();await t.signOut(),this.signedIn=!1}}async getEvents(t,s){try{if(!this.signedIn)throw new Error("Not signed in to Google Calendar");const a=new Date,r=new Date(a.getTime()+6048e5);return(await e.client.calendar.events.list({calendarId:"primary",timeMin:t||a.toISOString(),timeMax:s||r.toISOString(),showDeleted:!1,singleEvents:!0,maxResults:100,orderBy:"startTime"})).result.items||[]}catch(a){return console.error("Failed to fetch calendar events:",a),[]}}async createEvent(t){try{if(!this.signedIn)throw new Error("Not signed in to Google Calendar");return(await e.client.calendar.events.insert({calendarId:"primary",resource:t})).result}catch(s){return console.error("Failed to create calendar event:",s),null}}async updateEvent(t,s){try{if(!this.signedIn)throw new Error("Not signed in to Google Calendar");return(await e.client.calendar.events.patch({calendarId:"primary",eventId:t,resource:s})).result}catch(a){return console.error("Failed to update calendar event:",a),null}}async deleteEvent(t){try{if(!this.signedIn)throw new Error("Not signed in to Google Calendar");return await e.client.calendar.events.delete({calendarId:"primary",eventId:t}),!0}catch(s){return console.error("Failed to delete calendar event:",s),!1}}isSignedIn(){return this.signedIn}},x=()=>{const{user:e}=l(),{success:x,error:u}=o(),[m,g]=t.useState(new Date),[w,b]=t.useState([]),[p,v]=t.useState([]),[j,y]=t.useState(!0),[N,f]=t.useState(!1),[I,S]=t.useState(null),[C,D]=t.useState("month");t.useEffect(()=>{e&&(F(),G())},[e]);const F=async()=>{try{y(!0),await h.initializeGapi(),f(h.isSignedIn()),h.isSignedIn()&&await M()}catch(e){console.error("Failed to initialize calendar:",e),u("Failed to initialize Google Calendar")}finally{y(!1)}},G=()=>{if(!e)return;const t=c(e.uid,e=>{v(e)});return()=>t()},M=async()=>{try{const e=new Date(m.getFullYear(),m.getMonth(),1),t=new Date(m.getFullYear(),m.getMonth()+1,0),s=await h.getEvents(e.toISOString(),t.toISOString());b(s)}catch(e){console.error("Failed to load events:",e),u("Failed to load calendar events")}},k=e=>{const t=new Date(m);"prev"===e?t.setMonth(m.getMonth()-1):t.setMonth(m.getMonth()+1),g(t)},E=(e=>{const t=e.getFullYear(),s=e.getMonth(),a=new Date(t,s,1),r=new Date(t,s+1,0).getDate(),n=a.getDay(),i=[];for(let l=0;l<n;l++)i.push(null);for(let l=1;l<=r;l++)i.push(new Date(t,s,l));return i})(m);return e?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-indigo-900 to-purple-900 p-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"backdrop-blur-md bg-white/10 rounded-xl p-6 mb-6 border border-white/10",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl",children:s.jsx(a,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"Calendar"}),s.jsx("p",{className:"text-blue-200",children:"Manage your schedule and deadlines"})]})]}),s.jsx("div",{className:"flex items-center space-x-4",children:N?s.jsx("button",{onClick:async()=>{try{await h.signOut(),f(!1),b([]),x("Signed out from Google Calendar")}catch(e){console.error("Sign-out error:",e),u("Failed to sign out from Google Calendar")}},className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg border border-white/10 transition-all duration-200",children:"Disconnect"}):s.jsxs("button",{onClick:async()=>{try{await h.signIn()?(f(!0),await M(),x("Successfully connected to Google Calendar!")):u("Failed to sign in to Google Calendar")}catch(e){console.error("Sign-in error:",e),u("Failed to sign in to Google Calendar")}},className:"px-4 py-2 bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white rounded-lg transition-all duration-200 hover:scale-105 flex items-center space-x-2",children:[s.jsx(r,{className:"w-4 h-4"}),s.jsx("span",{children:"Connect Google Calendar"})]})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>k("prev"),className:"p-2 hover:bg-white/10 rounded-lg transition-all duration-200 text-white",children:s.jsx(n,{className:"w-5 h-5"})}),s.jsxs("h2",{className:"text-xl font-semibold text-white min-w-[200px] text-center",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][m.getMonth()]," ",m.getFullYear()]}),s.jsx("button",{onClick:()=>k("next"),className:"p-2 hover:bg-white/10 rounded-lg transition-all duration-200 text-white",children:s.jsx(i,{className:"w-5 h-5"})})]}),s.jsx("button",{onClick:()=>g(new Date),className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg border border-white/10 transition-all duration-200",children:"Today"})]})]}),j?s.jsx("div",{className:"flex justify-center items-center py-20",children:s.jsx(d,{size:"xl"})}):s.jsxs("div",{className:"backdrop-blur-md bg-white/10 rounded-xl border border-white/10 overflow-hidden",children:[s.jsx("div",{className:"grid grid-cols-7 bg-white/5",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>s.jsx("div",{className:"p-4 text-center font-semibold text-white border-r border-white/10 last:border-r-0",children:e},e))}),s.jsx("div",{className:"grid grid-cols-7",children:E.map((e,t)=>{const a=e&&e.toDateString()===(new Date).toDateString(),r=e?(e=>{if(!e)return[];const t=e.toDateString();return[...w.filter(e=>(e.start.dateTime?new Date(e.start.dateTime):new Date(e.start.date)).toDateString()===t),...p.filter(e=>!!e.deadline&&new Date(e.deadline).toDateString()===t)]})(e):[],n=e&&e.getMonth()===m.getMonth();return s.jsx("div",{className:`min-h-[120px] p-2 border-r border-b border-white/10 last:border-r-0 transition-all duration-200 ${e?"cursor-pointer hover:bg-white/5":""} ${a?"bg-blue-500/20":""} ${n?"":"opacity-50"}`,onClick:()=>e&&S(e),children:e&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium mb-2 "+(a?"bg-blue-500 text-white":"text-white hover:bg-white/10"),children:e.getDate()}),s.jsxs("div",{className:"space-y-1",children:[r.slice(0,3).map((e,t)=>{const a="priority"in e;return s.jsx("div",{className:"text-xs p-1 rounded text-white truncate "+(a?"high"===e.priority?"bg-red-500/80":"medium"===e.priority?"bg-yellow-500/80":"bg-green-500/80":"bg-blue-500/80"),title:a?e.title:e.summary,children:a?e.title:e.summary},t)}),r.length>3&&s.jsxs("div",{className:"text-xs text-blue-200 text-center",children:["+",r.length-3," more"]})]})]})},t)})})]}),!N&&s.jsx("div",{className:"mt-6 backdrop-blur-md bg-white/10 rounded-xl p-6 border border-white/10",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:s.jsx(r,{className:"w-5 h-5 text-yellow-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-white",children:"Connect Your Google Calendar"}),s.jsx("p",{className:"text-blue-200 text-sm",children:"Connect your Google Calendar to sync events and create a unified schedule view"})]})]})}),s.jsxs("div",{className:"mt-6 backdrop-blur-md bg-white/10 rounded-xl p-6 border border-white/10",children:[s.jsx("h3",{className:"font-semibold text-white mb-3",children:"Legend"}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded"}),s.jsx("span",{className:"text-blue-200 text-sm",children:"Calendar Events"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),s.jsx("span",{className:"text-blue-200 text-sm",children:"High Priority Tasks"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded"}),s.jsx("span",{className:"text-blue-200 text-sm",children:"Medium Priority Tasks"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),s.jsx("span",{className:"text-blue-200 text-sm",children:"Low Priority Tasks"})]})]})]})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-indigo-900 to-purple-900 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(a,{className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Calendar"}),s.jsx("p",{className:"text-blue-200",children:"Please log in to view your calendar"})]})})};export{x as default};
