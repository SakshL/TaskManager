import{r as e,j as t,bq as a,aR as s,aI as r,az as o,Q as l,Z as d,au as i,br as n,bs as c,bt as x,bu as m,bv as g,bw as h,bx as p,by as u,bz as b,ap as j,bA as y,bB as f,bC as k,aw as v}from"./react-vendor-CvFIN_ac.js";import{b as N,L as w}from"./index-B8kPX3kX.js";import{s as T,g as D}from"./firestore-lbgXwKY1.js";const S=({value:a,duration:s=1e3,suffix:r="",prefix:o=""})=>{const[l,d]=e.useState(0);return e.useEffect(()=>{let e,t;const r=o=>{e||(e=o);const l=Math.min((o-e)/s,1);d(Math.floor(l*a)),l<1&&(t=requestAnimationFrame(r))};return t=requestAnimationFrame(r),()=>{t&&cancelAnimationFrame(t)}},[a,s]),t.jsxs("span",{children:[o,l,r]})},P=()=>{const{user:P}=N(),[F,$]=e.useState([]),[R,C]=e.useState([]),[A,E]=e.useState(!0),[L,O]=e.useState("week");e.useEffect(()=>{if(P){const e=T(P.uid,e=>{$(e),E(!1)});return K(),()=>e()}},[P]);const K=async()=>{if(P)try{const e=await D(P.uid);C(e)}catch(e){console.error("Error loading pomodoro data:",e)}},M=e.useMemo(()=>{const e=new Date,t=new Date;switch(L){case"week":t.setDate(e.getDate()-7);break;case"month":t.setMonth(e.getMonth()-1);break;case"year":t.setFullYear(e.getFullYear()-1)}const a=F.filter(e=>new Date(e.createdAt)>=t),s=R.filter(e=>new Date(e.startTime)>=t),r=a.filter(e=>"completed"===e.status),o=a.length>0?r.length/a.length*100:0,l=s.filter(e=>e.completed&&"work"===e.type).reduce((e,t)=>e+t.duration,0),d=[];for(let g=6;g>=0;g--){const e=new Date;e.setDate(e.getDate()-g);const t=F.filter(t=>new Date(t.createdAt).toDateString()===e.toDateString()),a=t.filter(e=>"completed"===e.status).length,s=R.filter(t=>new Date(t.startTime).toDateString()===e.toDateString()&&t.completed).length;d.push({date:e.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),tasks:t.length,completed:a,pomodoros:s,focusTime:R.filter(t=>new Date(t.startTime).toDateString()===e.toDateString()&&t.completed&&"work"===t.type).reduce((e,t)=>e+t.duration,0)})}const i=F.reduce((e,t)=>(e[t.subject]||(e[t.subject]={total:0,completed:0}),e[t.subject].total++,"completed"===t.status&&e[t.subject].completed++,e),{}),n=F.reduce((e,t)=>(e[t.priority]||(e[t.priority]={total:0,completed:0}),e[t.priority].total++,"completed"===t.status&&e[t.priority].completed++,e),{}),c=d.reduce((e,t)=>e+t.tasks,0)/7,x=d.reduce((e,t)=>e+t.pomodoros,0)/7,m=d.reduce((e,t)=>e+t.focusTime,0)/7;return{totalTasks:a.length,completedTasks:r.length,completionRate:o,totalFocusTime:l,totalPomodoros:s.filter(e=>e.completed).length,dailyData:d,subjectStats:i,priorityStats:n,avgTasksPerDay:c,avgPomodorosPerDay:x,avgFocusTimePerDay:m}},[F,R,L]);if(A)return t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx(w,{size:"xl",text:"Loading your analytics..."})});const z=(I=M.completionRate)>=90?{grade:"A+",color:"text-green-600",bg:"bg-green-100"}:I>=80?{grade:"A",color:"text-green-600",bg:"bg-green-100"}:I>=70?{grade:"B",color:"text-blue-600",bg:"bg-blue-100"}:I>=60?{grade:"C",color:"text-yellow-600",bg:"bg-yellow-100"}:{grade:"D",color:"text-red-600",bg:"bg-red-100"};var I;return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50 dark:from-emerald-900 dark:via-teal-900 dark:to-cyan-900 p-4 sm:p-6 lg:p-8",children:t.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[t.jsxs("div",{className:"text-center mb-8","data-aos":"fade-down",children:[t.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-emerald-600 via-teal-600 to-cyan-600 bg-clip-text text-transparent mb-4",children:"Performance Analytics"}),t.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:"Discover insights about your productivity and learning progress 📊"})]}),t.jsx("div",{className:"glass rounded-3xl p-6 border border-white/20 mb-8","data-aos":"fade-up",children:t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(a,{className:"w-5 h-5 text-gray-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Time Period:"}),t.jsx("div",{className:"flex gap-2",children:["week","month","year"].map(e=>t.jsxs("button",{onClick:()=>O(e),className:"px-4 py-2 rounded-xl font-medium transition-all duration-200 "+(L===e?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:["Last ",e]},e))})]}),t.jsxs("button",{onClick:()=>{const e=`\nTASKTIDE ANALYTICS REPORT\n========================\nPeriod: Last ${L}\nGenerated: ${(new Date).toLocaleString()}\n\nOVERVIEW\n--------\nTotal Tasks: ${M.totalTasks}\nCompleted Tasks: ${M.completedTasks}\nCompletion Rate: ${M.completionRate.toFixed(1)}%\nTotal Focus Time: ${Math.round(M.totalFocusTime/60)}h ${M.totalFocusTime%60}m\nTotal Pomodoros: ${M.totalPomodoros}\n\nDAILY AVERAGES\n--------------\nTasks per day: ${M.avgTasksPerDay.toFixed(1)}\nPomodoros per day: ${M.avgPomodorosPerDay.toFixed(1)}\nFocus time per day: ${Math.round(M.avgFocusTimePerDay)}m\n\nSUBJECT BREAKDOWN\n-----------------\n${Object.entries(M.subjectStats).map(([e,t])=>`${e}: ${t.completed}/${t.total} (${(t.completed/t.total*100).toFixed(1)}%)`).join("\n")}\n\nDAILY BREAKDOWN\n---------------\n${M.dailyData.map(e=>`${e.date}: ${e.completed}/${e.tasks} tasks, ${e.pomodoros} pomodoros, ${e.focusTime}m focus`).join("\n")}\n`,t=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`tasktide-analytics-${(new Date).toISOString().split("T")[0]}.txt`,s.click(),URL.revokeObjectURL(a)},className:"px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors duration-200 flex items-center gap-2",children:[t.jsx(s,{className:"w-4 h-4"}),"Export Report"]})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[t.jsxs("div",{className:"glass rounded-3xl p-6 border border-white/20 text-center","data-aos":"fade-up",children:[t.jsx("div",{className:"flex items-center justify-center mb-4",children:t.jsx("div",{className:`p-4 rounded-full ${z.bg}`,children:t.jsx(r,{className:`w-8 h-8 ${z.color}`})})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Overall Grade"}),t.jsx("div",{className:`text-3xl font-bold ${z.color} mb-2`,children:z.grade}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[M.completionRate.toFixed(1),"% completion rate"]})]}),t.jsxs("div",{className:"glass rounded-3xl p-6 border border-white/20","data-aos":"fade-up","data-aos-delay":"100",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"p-3 rounded-xl bg-green-100 dark:bg-green-900/30",children:t.jsx(o,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Tasks Completed"}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["This ",L]})]})]}),t.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:t.jsx(S,{value:M.completedTasks})}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["of ",t.jsx(S,{value:M.totalTasks})," total tasks"]})]}),t.jsxs("div",{className:"glass rounded-3xl p-6 border border-white/20","data-aos":"fade-up","data-aos-delay":"200",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"p-3 rounded-xl bg-purple-100 dark:bg-purple-900/30",children:t.jsx(l,{className:"w-6 h-6 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Focus Time"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total minutes"})]})]}),t.jsxs("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:[t.jsx(S,{value:Math.round(M.totalFocusTime/60),suffix:"h"})," ",t.jsx(S,{value:M.totalFocusTime%60,suffix:"m"})]}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx(S,{value:M.totalPomodoros})," pomodoro sessions"]})]}),t.jsxs("div",{className:"glass rounded-3xl p-6 border border-white/20","data-aos":"fade-up","data-aos-delay":"300",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"p-3 rounded-xl bg-orange-100 dark:bg-orange-900/30",children:t.jsx(d,{className:"w-6 h-6 text-orange-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Daily Average"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Tasks per day"})]})]}),t.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:M.avgTasksPerDay.toFixed(1)}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[M.avgPomodorosPerDay.toFixed(1)," pomodoros/day"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsxs("div",{className:"glass rounded-3xl p-6 border border-white/20","data-aos":"fade-up",children:[t.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[t.jsx(i,{className:"w-6 h-6 text-blue-600"}),"Daily Progress"]}),t.jsx("div",{className:"h-80",children:t.jsx(n,{width:"100%",height:"100%",children:t.jsxs(c,{data:M.dailyData,children:[t.jsx(x,{strokeDasharray:"3 3",opacity:.3}),t.jsx(m,{dataKey:"date",fontSize:12,tick:{fill:"currentColor"}}),t.jsx(g,{fontSize:12,tick:{fill:"currentColor"}}),t.jsx(h,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"none",borderRadius:"12px",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1)"}}),t.jsx(p,{dataKey:"completed",fill:"#10b981",name:"Completed Tasks",radius:[4,4,0,0]}),t.jsx(p,{dataKey:"tasks",fill:"#e5e7eb",name:"Total Tasks",radius:[4,4,0,0]})]})})})]}),t.jsxs("div",{className:"glass rounded-3xl p-6 border border-white/20","data-aos":"fade-up","data-aos-delay":"100",children:[t.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[t.jsx(l,{className:"w-6 h-6 text-purple-600"}),"Focus Time Trend"]}),t.jsx("div",{className:"h-80",children:t.jsx(n,{width:"100%",height:"100%",children:t.jsxs(u,{data:M.dailyData,children:[t.jsx(x,{strokeDasharray:"3 3",opacity:.3}),t.jsx(m,{dataKey:"date",fontSize:12,tick:{fill:"currentColor"}}),t.jsx(g,{fontSize:12,tick:{fill:"currentColor"}}),t.jsx(h,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"none",borderRadius:"12px",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1)"}}),t.jsx(b,{type:"monotone",dataKey:"focusTime",stroke:"#8b5cf6",strokeWidth:3,dot:{fill:"#8b5cf6",strokeWidth:2,r:4},activeDot:{r:6},name:"Focus Time (min)"}),t.jsx(b,{type:"monotone",dataKey:"pomodoros",stroke:"#06b6d4",strokeWidth:2,dot:{fill:"#06b6d4",strokeWidth:2,r:3},name:"Pomodoro Sessions"})]})})})]})]}),t.jsxs("div",{className:"glass rounded-3xl p-6 border border-white/20 mt-8","data-aos":"fade-up",children:[t.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[t.jsx(j,{className:"w-6 h-6 text-orange-600"}),"Subject Performance"]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsx("div",{className:"h-80",children:t.jsx(n,{width:"100%",height:"100%",children:t.jsxs(y,{children:[t.jsx(f,{data:Object.entries(M.subjectStats).map(([e,t])=>({name:e,value:t.completed,total:t.total})),cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:e,value:t})=>`${e}: ${t}`,children:Object.entries(M.subjectStats).map((e,a)=>t.jsx(k,{fill:["#8b5cf6","#06b6d4","#10b981","#f59e0b","#ef4444","#8b5cf6"][a%6]},`cell-${a}`))}),t.jsx(h,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"none",borderRadius:"12px",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1)"}})]})})}),t.jsxs("div",{className:"space-y-4",children:[Object.entries(M.subjectStats).map(([e,a],s)=>{const r=a.total>0?a.completed/a.total*100:0,o=["bg-purple-500","bg-cyan-500","bg-green-500","bg-yellow-500","bg-red-500"];return t.jsxs("div",{className:"space-y-2","data-aos":"slide-left","data-aos-delay":100*s,children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 capitalize",children:e}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.jsx(S,{value:r,suffix:"%"})})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:t.jsx("div",{className:`${o[s%o.length]} h-3 rounded-full transition-all duration-500`,style:{width:`${r}%`}})}),t.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[t.jsxs("span",{children:[t.jsx(S,{value:a.completed})," completed"]}),t.jsxs("span",{children:[t.jsx(S,{value:a.total})," total"]})]})]},e)}),0===Object.keys(M.subjectStats).length&&t.jsxs("div",{className:"text-center py-8",children:[t.jsx(j,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No subject data available"})]})]})]})]}),t.jsxs("div",{className:"glass rounded-3xl p-8 border border-white/20","data-aos":"fade-up",children:[t.jsxs("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[t.jsx(v,{className:"w-8 h-8 text-emerald-600"}),"Insights & Recommendations"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-900/30 dark:to-teal-900/30 border border-emerald-200 dark:border-emerald-700",children:[t.jsx("h4",{className:"font-bold text-emerald-800 dark:text-emerald-200 mb-3",children:"🎯 Productivity"}),t.jsx("p",{className:"text-sm text-emerald-700 dark:text-emerald-300 mb-2",children:M.completionRate>=80?"Excellent work! You're consistently hitting your targets.":M.completionRate>=60?"Good progress! Try breaking larger tasks into smaller chunks.":"Consider setting more realistic daily goals to build momentum."}),t.jsxs("p",{className:"text-xs text-emerald-600 dark:text-emerald-400",children:["Current completion rate: ",M.completionRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/30 dark:to-pink-900/30 border border-purple-200 dark:border-purple-700",children:[t.jsx("h4",{className:"font-bold text-purple-800 dark:text-purple-200 mb-3",children:"⏰ Focus Time"}),t.jsx("p",{className:"text-sm text-purple-700 dark:text-purple-300 mb-2",children:M.avgFocusTimePerDay>=120?"Great focus! You're maintaining excellent concentration habits.":M.avgFocusTimePerDay>=60?"Good focus time! Try adding one more Pomodoro session per day.":"Consider using the Pomodoro technique to improve focus duration."}),t.jsxs("p",{className:"text-xs text-purple-600 dark:text-purple-400",children:["Daily average: ",Math.round(M.avgFocusTimePerDay)," minutes"]})]}),t.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-orange-50 to-yellow-50 dark:from-orange-900/30 dark:to-yellow-900/30 border border-orange-200 dark:border-orange-700",children:[t.jsx("h4",{className:"font-bold text-orange-800 dark:text-orange-200 mb-3",children:"🔥 Consistency"}),t.jsx("p",{className:"text-sm text-orange-700 dark:text-orange-300 mb-2",children:M.avgTasksPerDay>=3?"Fantastic consistency! You're building strong productivity habits.":M.avgTasksPerDay>=1?"Good daily rhythm! Try to maintain this consistency.":"Start with small daily goals to build a consistent habit."}),t.jsxs("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:["Daily task average: ",M.avgTasksPerDay.toFixed(1)," tasks"]})]})]})]})]})})};export{P as default};
