import{r as e,bD as t,bG as a,bF as r,bE as s,bI as d,ao as l,j as x,bT as c,B as i,n,bR as g,bL as o,bi as m,bK as h}from"./react-vendor-CimZ8x-k.js";import{b as y,d as p,L as u}from"./index-CE1QBjke.js";const b=()=>{const{user:b}=y(),[j,w]=e.useState([]),[k,N]=e.useState(!0),[f,v]=e.useState(!1),[G,C]=e.useState({subject:"",assignment:"",grade:"",maxGrade:"",date:"",type:"assignment"}),[A,S]=e.useState("all");e.useEffect(()=>{b&&F()},[b]);const F=async()=>{if(b)try{const e=t(a(p,"grades"),r("userId","==",b.uid),s("date","desc")),l=(await d(e)).docs.map(e=>({id:e.id,...e.data()}));w(l)}catch(e){console.error("Error fetching grades:",e),l.error("Failed to fetch grades")}finally{N(!1)}},E=e=>e>=90?"text-green-600":e>=80?"text-blue-600":e>=70?"text-yellow-600":e>=60?"text-orange-600":"text-red-600";if(k)return x.jsx("div",{className:"flex justify-center items-center h-64",children:x.jsx(u,{})});const z="all"===A?j:j.filter(e=>e.subject===A),I=(e=>{if(0===e.length)return 0;return(e.reduce((e,t)=>e+t.grade/t.maxGrade*100,0)/e.length/25).toFixed(2)})(z);return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center",children:[x.jsx(c,{className:"w-8 h-8 mr-3 text-yellow-500"}),"Grade Tracker"]}),x.jsxs("button",{onClick:()=>v(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center",children:[x.jsx(i,{className:"w-5 h-5 mr-2"}),"Add Grade"]})]}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm",children:x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Current GPA"}),x.jsx("p",{className:"text-3xl font-bold text-blue-600",children:I})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Grades"}),x.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:z.length})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Average Score"}),x.jsx("p",{className:"text-3xl font-bold text-green-600",children:z.length>0?`${(z.reduce((e,t)=>e+t.grade/t.maxGrade*100,0)/z.length).toFixed(1)}%`:"0%"})]})]})}),x.jsx("div",{className:"flex space-x-4",children:x.jsxs("select",{value:A,onChange:e=>S(e.target.value),className:"border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:"all",children:"All Subjects"}),[...new Set(j.map(e=>e.subject))].sort().map(e=>x.jsx("option",{value:e,children:e},e))]})}),x.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm",children:0===z.length?x.jsxs("div",{className:"p-8 text-center",children:[x.jsx(n,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),x.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No grades found. Add your first grade to get started!"})]}):x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"w-full",children:[x.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:x.jsxs("tr",{children:[x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Subject"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Assignment"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Grade"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Percentage"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Type"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),x.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),x.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:z.map(e=>{const t=e.grade/e.maxGrade*100;return x.jsxs("tr",{children:[x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.subject}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.assignment}),x.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:[e.grade,"/",e.maxGrade]}),x.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-semibold ${E(t)}`,children:[t.toFixed(1),"%"]}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 capitalize",children:e.type}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.date}),x.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x.jsx("button",{onClick:()=>(async e=>{if(b)try{await o(m(p,"grades",e)),l.success("Grade deleted successfully"),F()}catch(t){console.error("Error deleting grade:",t),l.error("Failed to delete grade")}})(e.id),className:"text-red-600 hover:text-red-900",children:x.jsx(g,{className:"w-5 h-5"})})})]},e.id)})})]})})}),f&&x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[x.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Add New Grade"}),x.jsxs("div",{className:"space-y-4",children:[x.jsx("input",{type:"text",placeholder:"Subject",value:G.subject,onChange:e=>C({...G,subject:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),x.jsx("input",{type:"text",placeholder:"Assignment/Exam Name",value:G.assignment,onChange:e=>C({...G,assignment:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsx("input",{type:"number",placeholder:"Grade",value:G.grade,onChange:e=>C({...G,grade:e.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),x.jsx("input",{type:"number",placeholder:"Max Grade",value:G.maxGrade,onChange:e=>C({...G,maxGrade:e.target.value}),className:"border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),x.jsxs("select",{value:G.type,onChange:e=>C({...G,type:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[x.jsx("option",{value:"assignment",children:"Assignment"}),x.jsx("option",{value:"exam",children:"Exam"}),x.jsx("option",{value:"quiz",children:"Quiz"}),x.jsx("option",{value:"project",children:"Project"})]}),x.jsx("input",{type:"date",value:G.date,onChange:e=>C({...G,date:e.target.value}),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),x.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[x.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Cancel"}),x.jsx("button",{onClick:async()=>{if(b&&G.subject&&G.assignment&&G.grade&&G.maxGrade&&G.date)try{const e={subject:G.subject,assignment:G.assignment,grade:parseFloat(G.grade),maxGrade:parseFloat(G.maxGrade),date:G.date,type:G.type,userId:b.uid,createdAt:(new Date).toISOString()};await h(a(p,"grades"),e),l.success("Grade added successfully"),C({subject:"",assignment:"",grade:"",maxGrade:"",date:"",type:"assignment"}),v(!1),F()}catch(e){console.error("Error adding grade:",e),l.error("Failed to add grade")}else l.error("Please fill in all fields")},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",children:"Add Grade"})]})]})})]})};export{b as default};
