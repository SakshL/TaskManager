import{as as a,at as t,au as e,av as s,aw as d,ax as o,k as r,ay as n,az as i,aA as c,aB as m}from"./react-vendor-BiMSSdjs.js";import{d as u}from"./index-rZ25EgeA.js";const p=new Map,l=async a=>{const t=new Date,e={...a,createdAt:n.fromDate(t),updatedAt:n.fromDate(t)};return(await m(s(u,"tasks"),e)).id},D=async(a,t)=>{const e=r(u,"tasks",a),s={...t,updatedAt:n.fromDate(new Date)};await i(e,s)},w=async a=>{const t=r(u,"tasks",a);await c(t)},A=async d=>{const r=((a,t)=>t?`${a}_${t}`:a)("tasks",d),n=p.get(r);if((i=n)&&Date.now()-i.timestamp<3e4)return n.data;var i;const c=a(s(u,"tasks"),e("userId","==",d),t("createdAt","desc")),m=(await o(c)).docs.map(a=>({id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate(),updatedAt:a.data().updatedAt?.toDate(),deadline:a.data().deadline?.toDate()}));return p.set(r,{data:m,timestamp:Date.now()}),m},y=async a=>{const t={...a,startTime:n.fromDate(a.startTime),endTime:a.endTime?n.fromDate(a.endTime):null};return(await m(s(u,"pomodoroSessions"),t)).id},T=async(a,t)=>{const e=r(u,"pomodoroSessions",a),s={...t,endTime:t.endTime?n.fromDate(t.endTime):null};await i(e,s)},f=async d=>{const r=a(s(u,"pomodoroSessions"),e("userId","==",d),t("startTime","desc"));return(await o(r)).docs.map(a=>({id:a.id,...a.data(),startTime:a.data().startTime?.toDate(),endTime:a.data().endTime?.toDate()}))},g=(o,r)=>{const n=a(s(u,"tasks"),e("userId","==",o),t("createdAt","desc"));return d(n,a=>{const t=a.docs.map(a=>({id:a.id,...a.data(),createdAt:a.data().createdAt?.toDate(),updatedAt:a.data().updatedAt?.toDate(),deadline:a.data().deadline?.toDate()}));r(t)},a=>{console.error("Error listening to tasks:",a)})},k=async a=>{const t={...a,timestamp:n.fromDate(new Date)};return(await m(s(u,"chatMessages"),t)).id},h=(o,r)=>{const n=a(s(u,"chatMessages"),e("userId","==",o),t("timestamp","asc"));return d(n,a=>{const t=a.docs.map(a=>({id:a.id,...a.data(),timestamp:a.data().timestamp?.toDate()}));r(t)},a=>{console.error("Error listening to chat messages:",a)})},v=a=>(console.error("Firestore error:",a),"permission-denied"===a.code?"You do not have permission to perform this action.":"unavailable"===a.code?"Service is temporarily unavailable. Please try again.":"deadline-exceeded"===a.code?"Request timed out. Please check your connection and try again.":"An error occurred. Please try again.");export{h as a,k as b,l as c,w as d,A as e,T as f,f as g,v as h,y as i,g as s,D as u};
