import{r as e,j as r,aQ as a,aR as t,aL as s,as as n,aS as o,aT as l,aA as i,aU as d,aD as c,aV as p,aW as m,aX as u}from"./react-vendor-CimZ8x-k.js";import{b as x,a as g,L as h}from"./index-CE1QBjke.js";import{f as b}from"./openai-DwXsGvE0.js";import{a as f,b as y}from"./firestore-BNIH1E4J.js";const v=()=>{const{user:v}=x(),{success:w,error:j}=g(),[k,N]=e.useState([]),[S,C]=e.useState(""),[I,E]=e.useState(!1),[R,A]=e.useState(!1),[z,U]=e.useState([]),L=e.useRef(null),P=e.useRef(null),T=e.useRef(null);e.useEffect(()=>{if(v){console.log("ðŸ”¥ Loading chat messages for user:",v.uid);const e=f(v.uid,e=>{console.log("âœ… Received chat messages:",e.length,e);const r=e.map(e=>({id:e.id,content:e.content,role:e.role,timestamp:e.timestamp}));N(r)});return()=>e()}},[v]),e.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const e=window.webkitSpeechRecognition||window.SpeechRecognition;T.current=new e,T.current.continuous=!1,T.current.interimResults=!1,T.current.lang="en-US",T.current.onresult=e=>{const r=e.results[0][0].transcript;C(r),A(!1)},T.current.onerror=()=>{A(!1),j("Error","Speech recognition failed")},T.current.onend=()=>{A(!1)}}},[j]),e.useEffect(()=>{L.current?.scrollIntoView({behavior:"smooth"})},[k]),e.useEffect(()=>{v&&0===k.length&&setTimeout(()=>{if(0===k.length){const e={id:"welcome",content:`Hello ${v?.displayName?.split(" ")[0]||"there"}! ðŸ‘‹ I'm your AI study assistant. I can help you with:\n\nâ€¢ ðŸ“š **Study Planning** - Create personalized study schedules\nâ€¢ ðŸ§  **Concept Explanations** - Break down complex topics\nâ€¢ â“ **Practice Questions** - Generate quizzes and exercises\nâ€¢ ðŸ’¡ **Study Tips** - Improve your learning techniques\nâ€¢ ðŸ“ **Essay Help** - Structure and improve your writing\nâ€¢ ðŸ”¢ **Math & Science** - Solve problems step-by-step\n\nWhat would you like to work on today?`,role:"assistant",timestamp:new Date};N([e])}},1e3)},[v,k.length]);const $=[{icon:n,label:"Create Study Plan",prompt:"Create a detailed study plan for my upcoming exams. I need help organizing my study schedule.",color:"from-blue-500 to-blue-600"},{icon:o,label:"Solve Math Problem",prompt:"Help me solve a math problem step-by-step. Please explain each step clearly.",color:"from-green-500 to-green-600"},{icon:l,label:"Explain Concept",prompt:"Explain a complex concept in simple terms. Break it down so I can understand it better.",color:"from-purple-500 to-purple-600"},{icon:i,label:"Generate Quiz",prompt:"Create a practice quiz for me on a specific topic. Include multiple choice and short answer questions.",color:"from-orange-500 to-orange-600"}],D=async()=>{if(S.trim()&&!I&&v){Date.now().toString();try{await y({userId:v.uid,content:S,role:"user"})}catch(e){console.error("Error saving user message:",e)}C(""),E(!0);try{const r=`You are an intelligent study assistant for students. The user said: "${S}"\n\nPlease provide a helpful, educational response that:\n- Is clear and easy to understand\n- Uses examples when appropriate\n- Includes actionable advice\n- Is encouraging and supportive\n- Uses emojis sparingly but effectively\n\nRespond in a friendly, professional tone.`,a=await b(r);try{await y({userId:v.uid,content:a,role:"assistant"})}catch(e){console.error("Error saving AI message:",e)}}catch(e){console.error("Error sending message:",e),j("Error","Failed to get AI response. Please try again.")}finally{E(!1)}}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 dark:from-indigo-900 dark:via-purple-900 dark:to-pink-900 p-4 sm:p-6 lg:p-8",children:r.jsxs("div",{className:"max-w-6xl mx-auto h-[calc(100vh-4rem)] flex flex-col",children:[r.jsxs("div",{className:"text-center mb-6","data-aos":"fade-down",children:[r.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-4",children:"AI Study Assistant"}),r.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:"Your intelligent study companion powered by advanced AI ðŸ¤–"})]}),r.jsxs("div",{className:"flex-1 glass rounded-3xl border border-white/20 overflow-hidden flex flex-col","data-aos":"fade-up",children:[r.jsxs("div",{className:"p-6 border-b border-gray-200/50 dark:border-gray-700/50 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-xl bg-gradient-to-r from-purple-500/20 to-pink-500/20",children:r.jsx(a,{className:"w-6 h-6 text-purple-600"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"font-semibold text-gray-900 dark:text-white",children:"AI Assistant"}),r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Always here to help you learn"})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>{const e=k.map(e=>`${e.role.toUpperCase()}: ${e.content}\n`).join("\n"),r=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(r),t=document.createElement("a");t.href=a,t.download=`ai-chat-${(new Date).toISOString().split("T")[0]}.txt`,t.click(),URL.revokeObjectURL(a),w("Exported!","Chat saved to file")},className:"p-2 rounded-xl bg-blue-100 dark:bg-blue-900/30 text-blue-600 hover:scale-110 transition-transform duration-200",title:"Export chat",children:r.jsx(t,{className:"w-5 h-5"})}),r.jsx("button",{onClick:()=>{k.length>1&&(U(e=>[...e,k]),N([k[0]]),w("Cleared!","Chat cleared and saved to history"))},className:"p-2 rounded-xl bg-red-100 dark:bg-red-900/30 text-red-600 hover:scale-110 transition-transform duration-200",title:"Clear chat",children:r.jsx(s,{className:"w-5 h-5"})})]})]}),r.jsxs("div",{className:"p-6 border-b border-gray-200/50 dark:border-gray-700/50",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Quick Actions"}),r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:$.map((e,a)=>r.jsxs("button",{onClick:()=>{return r=e.prompt,C(r),void P.current?.focus();var r},className:`p-3 rounded-2xl bg-gradient-to-r ${e.color} text-white hover:scale-105 transition-all duration-200 text-left`,"data-aos":"zoom-in","data-aos-delay":100*a,children:[r.jsx(e.icon,{className:"w-5 h-5 mb-2"}),r.jsx("span",{className:"text-sm font-medium",children:e.label})]},e.label))})]}),r.jsxs("div",{className:"flex-1 p-6 overflow-y-auto space-y-6",children:[k.map(e=>r.jsxs("div",{className:"flex gap-4 "+("user"===e.role?"flex-row-reverse":""),"data-aos":"fade-up",children:[r.jsx("div",{className:"p-2 rounded-xl flex-shrink-0 "+("user"===e.role?"bg-blue-500 text-white":"bg-gradient-to-r from-purple-500 to-pink-500 text-white"),children:"user"===e.role?r.jsx(d,{className:"w-5 h-5"}):r.jsx(a,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1 max-w-3xl "+("user"===e.role?"text-right":""),children:[r.jsx("div",{className:"p-4 rounded-2xl "+("user"===e.role?"bg-blue-500 text-white ml-8":"bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 mr-8"),children:r.jsx("div",{className:"prose prose-sm max-w-none "+("user"===e.role?"text-white":"text-gray-900 dark:text-white"),children:e.content.split("\n").map((e,a)=>r.jsx("p",{className:"mb-2 last:mb-0",children:e},a))})}),r.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-gray-500 dark:text-gray-400 "+("user"===e.role?"justify-end":"justify-start"),children:[r.jsx("span",{children:e.timestamp.toLocaleTimeString()}),"assistant"===e.role&&r.jsx("button",{onClick:()=>{return r=e.content,navigator.clipboard.writeText(r),void w("Copied!","Message copied to clipboard");var r},className:"p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors duration-200",title:"Copy message",children:r.jsx(c,{className:"w-3 h-3"})})]})]})]},e.id)),I&&r.jsxs("div",{className:"flex gap-4","data-aos":"fade-up",children:[r.jsx("div",{className:"p-2 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 text-white flex-shrink-0",children:r.jsx(a,{className:"w-5 h-5"})}),r.jsx("div",{className:"flex-1 max-w-3xl",children:r.jsx("div",{className:"p-4 rounded-2xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 mr-8",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(h,{size:"sm"}),r.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"AI is thinking..."})]})})})]}),r.jsx("div",{ref:L})]}),r.jsx("div",{className:"p-6 border-t border-gray-200/50 dark:border-gray-700/50",children:r.jsxs("div",{className:"flex gap-4 items-end",children:[r.jsx("div",{className:"flex-1",children:r.jsx("textarea",{ref:P,value:S,onChange:e=>C(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),D())},placeholder:"Ask me anything about your studies...",rows:1,className:"w-full p-4 rounded-2xl border border-gray-200 dark:border-gray-600 bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none transition-all duration-200",style:{minHeight:"60px",maxHeight:"120px"}})}),T.current&&r.jsx("button",{onClick:R?()=>{T.current&&R&&(T.current.stop(),A(!1))}:()=>{T.current&&!R&&(A(!0),T.current.start())},className:"p-4 rounded-2xl transition-all duration-200 "+(R?"bg-red-500 text-white animate-pulse":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:scale-105"),title:R?"Stop recording":"Start voice input",children:R?r.jsx(p,{className:"w-6 h-6"}):r.jsx(m,{className:"w-6 h-6"})}),r.jsx("button",{onClick:D,disabled:!S.trim()||I,className:"p-4 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:scale-105 transition-transform duration-200 disabled:opacity-50 disabled:hover:scale-100",children:r.jsx(u,{className:"w-6 h-6"})})]})})]})]})})};export{v as default};
